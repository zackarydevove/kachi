generator client {
  provider = "prisma-client-js"
  output   = "../generated/prisma"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum AssetType {
  crypto
  real_estate
  stock
  cash
  exotic
}

model User {
  id           Int      @id @default(autoincrement())
  email        String   @unique
  password     String
  refreshToken String?
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt
  deletedAt    DateTime?

  accounts      Account[]
  assets    Asset[]
}

// TODO: Add a column "main account" if its main, then you cannot delete it if user is not deleted
model Account {
  id           Int      @id @default(autoincrement())
  name         String
  userId        Int
  avatar       String?

  user      User @relation(fields: [userId], references: [id])

  assets    Asset[]
}

model Asset {
  id           Int      @id @default(autoincrement())
  userId       Int
  accountId    Int
  name        String
  type        AssetType // (crypto, real_estate, stock, cash, divers) (enum)
  unitPrice   Int       // cannot be <0
  quantity    Int       // cannot be < 0
  value       Int
  // currency    String // for now only USD
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt
  deletedAt    DateTime?

  user      User  @relation(fields: [userId], references: [id])
  account Account @relation(fields: [accountId], references: [id])
  // liabilities  AssetLiability[] // ðŸ‘ˆ back-reference
}

// model Liability {
//   id           Int      @id @default(autoincrement())
//   // accountId         // later
//   name        String
//   amount      Int       // cannot be <0
//   // currency    String // for now only USD
//   createdAt    DateTime @default(now())
//   updatedAt    DateTime @updatedAt
//   deletedAt    DateTime?

//   assets       AssetLiability[] // ðŸ‘ˆ back-reference
// }

// model AssetLiability {
//   id          Int       @id @default(autoincrement())
//   assetId     Int
//   liabilityId Int

//   asset       Asset     @relation(fields: [assetId], references: [id])
//   liability   Liability @relation(fields: [liabilityId], references: [id])
// }

// model AssetSnapshot {
//   id          Int       @id @default(autoincrement())
//   // accountId   Int
//   label       AssetType
//   value       Int
//   date        DateTime
// }
